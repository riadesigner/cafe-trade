#!/bin/bash

# Pre-commit hook для запуска линтеров в client и server

echo "Running pre-commit checks..."

# Функция для проверки выполнения команды
check_status() {
    if [ $? -ne 0 ]; then
        echo "Pre-commit checks failed in $1"
        exit 1
    fi
}

# Проверяем client
if [ -d "client" ] && [ -f "client/package.json" ]; then
    echo "Checking client..."
    cd client
    if grep -q '"precommit"' package.json; then
        npm run precommit
        check_status "client"
    fi
    cd ..
fi

# Проверяем server
if [ -d "server" ] && [ -f "server/package.json" ]; then
    echo "Checking server..."
    cd server
    if grep -q '"precommit"' package.json; then
        npm run precommit
        check_status "server"
    fi
    cd ..
fi

echo "Pre-commit checks passed! ✅"